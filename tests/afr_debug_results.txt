2025-12-12 12:19:40,523 - fedramp_20x_mcp.tools - INFO - Registered 36 tools across 12 modules
============================================================
AFR PATTERN DEBUGGING
============================================================

============================================================
TEST 1: Bicep TLS 1.0 Detection
============================================================

Testing: Bicep TLS 1.0
Pattern: minimumTlsVersion['\"]?\s*[:=]\s*['\"]?(TLS1_0|TLS1_1)
Code snippet: 
resource storageAccountWeak 'Microsoft.Storage/storageAccounts@2023-01-01' = {
  name: 'weakstorage...
[PASS] MATCH FOUND: minimumTlsVersion: 'TLS1_0

============================================================
TEST 2: Bicep HTTPS Disabled
============================================================

Testing: Bicep HTTPS disabled
Pattern: supportsHttpsTrafficOnly['\"]?\s*[:=]\s*false
Code snippet: 
resource storageInsecure 'Microsoft.Storage/storageAccounts@2023-01-01' = {
  properties: {
    sup...
[PASS] MATCH FOUND: supportsHttpsTrafficOnly: false

============================================================
TEST 3: Bicep Debug Mode
============================================================

Testing: Bicep debug mode
Pattern: name['\"]?\s*[:=]\s*['\"]ASPNETCORE_ENVIRONMENT['\"].*?value['\"]?\s*[:=]\s*['\"]Development['\"]
Code snippet: 
resource appServiceDebug 'Microsoft.Web/sites@2023-01-01' = {
  properties: {
    siteConfig: {
   ...
[FAIL] NO MATCH

============================================================
TEST 4: Python MD5 Detection
============================================================

Testing: Python MD5
Pattern: hashlib\.(md5|sha1|md4)
Code snippet: 
import hashlib
def hash_password_weak(password):
    hash_obj = hashlib.md5(password.encode())
    ...
[PASS] MATCH FOUND: hashlib.md5

============================================================
TEST 5: Python Debug Mode
============================================================

Testing: Python debug mode
Pattern: (debug\s*=\s*True|DEBUG\s*=\s*True|app\.debug\s*=\s*True)
Code snippet: 
from flask import Flask
app = Flask(__name__)
app.debug = True
...
[PASS] MATCH FOUND: app.debug = True

============================================================
PATTERN ENGINE TEST
============================================================

Loaded 4 AFR patterns from afr_patterns.yaml

AFR patterns loaded:
  - afr.crypto.weak_algorithms
  - afr.config.debug_mode
  - afr.scanning.missing_vulnerability_scan
  - afr.config.insecure_defaults

============================================================
TESTING LOADED PATTERNS
============================================================

Testing afr.crypto.weak_algorithms on Bicep TLS code...
Findings: 0

Testing afr.crypto.weak_algorithms on Python MD5 code...
Findings: 1
  - Weak or Deprecated Cryptographic Algorithms
    Pattern: afr.crypto.weak_algorithms
    Severity: critical

Testing afr.config.debug_mode on Python debug code...
Findings: 1
  - Debug Mode Enabled in Production
    Pattern: afr.config.debug_mode
    Severity: high

============================================================
DEBUG COMPLETE
============================================================
