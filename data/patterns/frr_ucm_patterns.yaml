# FRR UCM Patterns - FedRAMP 20x Requirements
# Family: UCM
# Pattern Type: Process-Based Requirements
# Schema: V2
#
# These patterns represent FedRAMP Requirements (FRR) which are
# primarily process-based and require documentation, policies,
# and procedures rather than code-level detection.
#
# NOTE: Manual completion required for:
# - Automation implementation code
# - Organization-specific policy details
# - Evidence collection procedures

pattern_id: frr.ucm.01
name: Cryptographic Module Documentation
description: Providers MUST document the cryptographic modules used in each service
  (or groups of services that use the same modules) where cryptographic services are
  used to protect federal customer data, including whether these modules are validated
  under the NIST Cryptographic Module Validation Program or are update streams of
  such modules.
family: UCM
severity: HIGH
pattern_type: process_based
languages:
  markdown:
    file_patterns:
    - '*.md'
    - README.md
    - SECURITY.md
    keywords: []
  yaml:
    file_patterns:
    - '*.yaml'
    - '*.yml'
    - .github/**/*.yml
    keywords:
    - fedramp
    - compliance
    - security
finding:
  title_template: Cryptographic Module Documentation - FRR-UCM-01
  description_template: Providers MUST document the cryptographic modules used in
    each service (or groups of services that use the same modules) where cryptographic
    services are used to protect federal customer data, including whether these modules
    are validated under the NIST Cryptographic Module Validation Program or are update
    streams of such modules.
  remediation_template: 'To comply with FRR-UCM-01 (Cryptographic Module Documentation),
    you MUST implement the following mandatory requirements:


    1. Review FedRAMP 20x requirement documentation

    2. Identify systems and resources in scope

    3. Create resource group for FedRAMP resources

    4. Set up Azure Key Vault for secrets management

    5. Configure Log Analytics workspace


    (See full implementation checklist for 10 total steps)'
  evidence_collection:
  - Configuration export from Azure Portal (JSON format)
  - Azure Policy compliance reports
  - Azure Monitor logs showing compliance status
  azure_services: &id001
  - Azure Blob Storage
  - Azure Monitor
  - Log Analytics
tags:
- ucm
- must
- process_based
- impact_low
- impact_moderate
- impact_high
- documentation_required
nist_controls:
- SC-13
- SA-4
related_ksis:
- KSI-AFR-01
related_frrs: []
evidence_collection:
  azure_monitor_kql: []
  azure_cli:
  - command: '# TODO: Add Azure CLI command for FRR-UCM-01'
    description: Collect evidence for Cryptographic Module Documentation
    output_format: json
    frequency: monthly
  powershell: []
  rest_api: []
  manual_procedures:
  - procedure: Configuration export from Azure Portal (JSON format)
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Policy compliance reports
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Monitor logs showing compliance status
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
evidence_artifacts:
- artifact_type: documentation
  name: FRR-UCM-01 - Cryptographic Module Documentation Policy
  source: Organization security documentation
  frequency: annual_review
  retention_months: 36
  format: PDF/Markdown
- artifact_type: configuration
  name: FRR-UCM-01 - Azure Service Configuration
  source: Azure Portal export
  frequency: quarterly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: FRR-UCM-01 - Compliance Status Report
  source: Compliance tracking system
  frequency: monthly
  retention_months: 36
  format: PDF/Excel
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: '# TODO: Add implementation for Azure Policy for compliance enforcement'
    azure_services: *id001
    effort_hours: 8
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: '# TODO: Add implementation for Azure Monitor for continuous monitoring'
    azure_services: *id001
    effort_hours: 8
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: '# TODO: Add implementation for Log Analytics queries for compliance
      validation'
    azure_services: *id001
    effort_hours: 8
implementation:
  prerequisites:
  - FedRAMP authorization package template
  - Organization security policies
  - Azure subscription (if applicable)
  - Security team approval process
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 6
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 7
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 8
    action: Implement automated compliance checking
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 9
    action: Set up automated evidence collection
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 10
    action: Test detection logic against sample code
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  total_effort_hours: 20
ssp_mapping:
  control_family: SC - Cryptographic Protection
  control_numbers:
  - SC-13
  - SA-4
  ssp_sections:
  - section: 'SC-13: Cryptographic Protection'
    description_template: 'Implementation of FRR-UCM-01 - Cryptographic Module Documentation:


      Providers MUST document the cryptographic modules used in each service (or groups
      of services that use the same modules) where cryptographic services are used
      to protect federal customer data, including whether these modules are validated
      under the NIST Cryptographic Module Validation Program or are update streams
      of such modules.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-01 Policy Documentation
    - FRR-UCM-01 Compliance Report
  - section: 'SA-4: Acquisition Process'
    description_template: 'Implementation of FRR-UCM-01 - Cryptographic Module Documentation:


      Providers MUST document the cryptographic modules used in each service (or groups
      of services that use the same modules) where cryptographic services are used
      to protect federal customer data, including whether these modules are validated
      under the NIST Cryptographic Module Validation Program or are update streams
      of such modules.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-01 Policy Documentation
    - FRR-UCM-01 Compliance Report
  required_for_fedramp: true
  authorization_package_section: Section 3 - Access Control
azure_guidance:
  recommended_services:
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Cryptographic Module Documentation compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Cryptographic Module Documentation compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Log Analytics
    tier: Standard
    purpose: Required for Cryptographic Module Documentation compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Govern
    guidance: Implement Cryptographic Module Documentation as part of governance baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/govern/
compliance_frameworks:
  fedramp_20x:
    requirement_id: FRR-UCM-01
    requirement_name: Cryptographic Module Documentation
    requirement_type: FRR
    primary_keyword: MUST
    impact_levels:
    - Low
    - Moderate
    - High
  nist_800_53_rev5:
    controls:
    - control_id: SC-13
      control_name: Cryptographic Protection
    - control_id: SA-4
      control_name: Acquisition Process
testing:
  validation_procedures:
  - procedure: Review policy documentation
    expected_outcome: Policy exists and is current (within 1 year)
    frequency: annual
  - procedure: Verify implementation evidence
    expected_outcome: Evidence artifacts collected and retained
    frequency: quarterly
  - procedure: Test automated controls (if applicable)
    expected_outcome: Automated controls functioning as designed
    frequency: monthly
  acceptance_criteria:
  - Policy documented for FRR-UCM-01
  - Implementation evidence collected and retained for 3 years
  - Annual review completed and documented
  - NIST controls SC-13, SA-4 satisfied

---
pattern_id: frr.ucm.02
name: Use of Validated Cryptographic Modules
description: Providers MUST configure agency tenants by default to use cryptographic
  services that use cryptographic modules or update streams of cryptographic modules
  with active validations under the NIST Cryptographic Module Validation Program when
  such modules are available.
family: UCM
severity: HIGH
pattern_type: process_based
languages:
  markdown:
    file_patterns:
    - '*.md'
    - README.md
    - SECURITY.md
    keywords: []
  yaml:
    file_patterns:
    - '*.yaml'
    - '*.yml'
    - .github/**/*.yml
    keywords:
    - fedramp
    - compliance
    - security
finding:
  title_template: Use of Validated Cryptographic Modules - FRR-UCM-02
  description_template: Providers MUST configure agency tenants by default to use
    cryptographic services that use cryptographic modules or update streams of cryptographic
    modules with active validations under the NIST Cryptographic Module Validation
    Program when such modules are available.
  remediation_template: 'To comply with FRR-UCM-02 (Use of Validated Cryptographic
    Modules), you MUST implement the following mandatory requirements:


    1. Review FedRAMP 20x requirement documentation

    2. Identify systems and resources in scope

    3. Create resource group for FedRAMP resources

    4. Set up Azure Key Vault for secrets management

    5. Configure Log Analytics workspace


    (See full implementation checklist for 10 total steps)'
  evidence_collection:
  - Configuration export from Azure Portal (JSON format)
  - Azure Policy compliance reports
  - Azure Monitor logs showing compliance status
  azure_services: &id001
  - Azure Blob Storage
  - Azure Monitor
  - Log Analytics
tags:
- ucm
- must
- process_based
- impact_low
- impact_moderate
- impact_high
- code_detectable
nist_controls:
- SC-13
- SC-12
- IA-7
related_ksis:
- KSI-CNA-05
- KSI-IAM-03
- KSI-CED-03
related_frrs: []
evidence_collection:
  azure_monitor_kql: []
  azure_cli:
  - command: '# TODO: Add Azure CLI command for FRR-UCM-02'
    description: Collect evidence for Use of Validated Cryptographic Modules
    output_format: json
    frequency: monthly
  powershell: []
  rest_api: []
  manual_procedures:
  - procedure: Configuration export from Azure Portal (JSON format)
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Policy compliance reports
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Monitor logs showing compliance status
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
evidence_artifacts:
- artifact_type: documentation
  name: FRR-UCM-02 - Use of Validated Cryptographic Modules Policy
  source: Organization security documentation
  frequency: annual_review
  retention_months: 36
  format: PDF/Markdown
- artifact_type: configuration
  name: FRR-UCM-02 - Azure Service Configuration
  source: Azure Portal export
  frequency: quarterly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: FRR-UCM-02 - Compliance Status Report
  source: Compliance tracking system
  frequency: monthly
  retention_months: 36
  format: PDF/Excel
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: '# TODO: Add implementation for Azure Policy for compliance enforcement'
    azure_services: *id001
    effort_hours: 8
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: '# TODO: Add implementation for Azure Monitor for continuous monitoring'
    azure_services: *id001
    effort_hours: 8
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: '# TODO: Add implementation for Log Analytics queries for compliance
      validation'
    azure_services: *id001
    effort_hours: 8
implementation:
  prerequisites:
  - FedRAMP authorization package template
  - Organization security policies
  - Azure subscription (if applicable)
  - Security team approval process
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 6
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 7
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 8
    action: Implement automated compliance checking
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 9
    action: Set up automated evidence collection
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 10
    action: Test detection logic against sample code
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  total_effort_hours: 20
ssp_mapping:
  control_family: SC - Cryptographic Protection
  control_numbers:
  - SC-13
  - SC-12
  - IA-7
  ssp_sections:
  - section: 'SC-13: Cryptographic Protection'
    description_template: 'Implementation of FRR-UCM-02 - Use of Validated Cryptographic
      Modules:


      Providers MUST configure agency tenants by default to use cryptographic services
      that use cryptographic modules or update streams of cryptographic modules with
      active validations under the NIST Cryptographic Module Validation Program when
      such modules are available.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-02 Policy Documentation
    - FRR-UCM-02 Compliance Report
  - section: 'SC-12: Cryptographic Key Establishment and Management'
    description_template: 'Implementation of FRR-UCM-02 - Use of Validated Cryptographic
      Modules:


      Providers MUST configure agency tenants by default to use cryptographic services
      that use cryptographic modules or update streams of cryptographic modules with
      active validations under the NIST Cryptographic Module Validation Program when
      such modules are available.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-02 Policy Documentation
    - FRR-UCM-02 Compliance Report
  - section: 'IA-7: Cryptographic Module Authentication'
    description_template: 'Implementation of FRR-UCM-02 - Use of Validated Cryptographic
      Modules:


      Providers MUST configure agency tenants by default to use cryptographic services
      that use cryptographic modules or update streams of cryptographic modules with
      active validations under the NIST Cryptographic Module Validation Program when
      such modules are available.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-02 Policy Documentation
    - FRR-UCM-02 Compliance Report
  required_for_fedramp: true
  authorization_package_section: Section 3 - Access Control
azure_guidance:
  recommended_services:
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Use of Validated Cryptographic Modules compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Use of Validated Cryptographic Modules compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Log Analytics
    tier: Standard
    purpose: Required for Use of Validated Cryptographic Modules compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Govern
    guidance: Implement Use of Validated Cryptographic Modules as part of governance
      baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/govern/
compliance_frameworks:
  fedramp_20x:
    requirement_id: FRR-UCM-02
    requirement_name: Use of Validated Cryptographic Modules
    requirement_type: FRR
    primary_keyword: MUST
    impact_levels:
    - Low
    - Moderate
    - High
  nist_800_53_rev5:
    controls:
    - control_id: SC-13
      control_name: Cryptographic Protection
    - control_id: SC-12
      control_name: Cryptographic Key Establishment and Management
    - control_id: IA-7
      control_name: Cryptographic Module Authentication
testing:
  validation_procedures:
  - procedure: Review policy documentation
    expected_outcome: Policy exists and is current (within 1 year)
    frequency: annual
  - procedure: Verify implementation evidence
    expected_outcome: Evidence artifacts collected and retained
    frequency: quarterly
  - procedure: Test automated controls (if applicable)
    expected_outcome: Automated controls functioning as designed
    frequency: monthly
  acceptance_criteria:
  - Policy documented for FRR-UCM-02
  - Implementation evidence collected and retained for 3 years
  - Annual review completed and documented
  - NIST controls SC-13, SC-12, IA-7 satisfied

---
pattern_id: frr.ucm.03
name: Update Streams (Moderate)
description: Providers SHOULD use cryptographic modules or update streams of cryptographic
  modules with active validations under the NIST Cryptographic Module Validation Program
  when using cryptographic services to protect _federal customer data_.
family: UCM
severity: MEDIUM
pattern_type: process_based
languages:
  markdown:
    file_patterns:
    - '*.md'
    - README.md
    - SECURITY.md
    keywords: []
  yaml:
    file_patterns:
    - '*.yaml'
    - '*.yml'
    - .github/**/*.yml
    keywords:
    - fedramp
    - compliance
    - security
finding:
  title_template: Update Streams (Moderate) - FRR-UCM-03
  description_template: Providers SHOULD use cryptographic modules or update streams
    of cryptographic modules with active validations under the NIST Cryptographic
    Module Validation Program when using cryptographic services to protect _federal
    customer data_.
  remediation_template: 'To comply with FRR-UCM-03 (Update Streams (Moderate)), you
    SHOULD consider implementing the following recommended practices:


    1. Review FedRAMP 20x requirement documentation

    2. Identify systems and resources in scope

    3. Create resource group for FedRAMP resources

    4. Set up Azure Key Vault for secrets management

    5. Configure Log Analytics workspace


    (See full implementation checklist for 10 total steps)'
  evidence_collection:
  - Configuration export from Azure Portal (JSON format)
  - Azure Policy compliance reports
  - Azure Monitor logs showing compliance status
  azure_services: &id001
  - Azure Blob Storage
  - Azure Monitor
  - Log Analytics
tags:
- ucm
- should
- process_based
- impact_moderate
- code_detectable
nist_controls:
- SC-13
- SC-12
- IA-7
related_ksis:
- KSI-CNA-05
- KSI-CED-03
related_frrs: []
evidence_collection:
  azure_monitor_kql: []
  azure_cli:
  - command: '# TODO: Add Azure CLI command for FRR-UCM-03'
    description: Collect evidence for Update Streams (Moderate)
    output_format: json
    frequency: monthly
  powershell: []
  rest_api: []
  manual_procedures:
  - procedure: Configuration export from Azure Portal (JSON format)
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Policy compliance reports
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Monitor logs showing compliance status
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
evidence_artifacts:
- artifact_type: documentation
  name: FRR-UCM-03 - Update Streams (Moderate) Policy
  source: Organization security documentation
  frequency: annual_review
  retention_months: 36
  format: PDF/Markdown
- artifact_type: configuration
  name: FRR-UCM-03 - Azure Service Configuration
  source: Azure Portal export
  frequency: quarterly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: FRR-UCM-03 - Compliance Status Report
  source: Compliance tracking system
  frequency: monthly
  retention_months: 36
  format: PDF/Excel
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: '# TODO: Add implementation for Azure Policy for compliance enforcement'
    azure_services: *id001
    effort_hours: 8
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: '# TODO: Add implementation for Azure Monitor for continuous monitoring'
    azure_services: *id001
    effort_hours: 8
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: '# TODO: Add implementation for Log Analytics queries for compliance
      validation'
    azure_services: *id001
    effort_hours: 8
implementation:
  prerequisites:
  - FedRAMP authorization package template
  - Organization security policies
  - Azure subscription (if applicable)
  - Security team approval process
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 6
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 7
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 8
    action: Implement automated compliance checking
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 9
    action: Set up automated evidence collection
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 10
    action: Test detection logic against sample code
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  total_effort_hours: 20
ssp_mapping:
  control_family: SC - Cryptographic Protection
  control_numbers:
  - SC-13
  - SC-12
  - IA-7
  ssp_sections:
  - section: 'SC-13: Cryptographic Protection'
    description_template: 'Implementation of FRR-UCM-03 - Update Streams (Moderate):


      Providers SHOULD use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-03 Policy Documentation
    - FRR-UCM-03 Compliance Report
  - section: 'SC-12: Cryptographic Key Establishment and Management'
    description_template: 'Implementation of FRR-UCM-03 - Update Streams (Moderate):


      Providers SHOULD use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-03 Policy Documentation
    - FRR-UCM-03 Compliance Report
  - section: 'IA-7: Cryptographic Module Authentication'
    description_template: 'Implementation of FRR-UCM-03 - Update Streams (Moderate):


      Providers SHOULD use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-03 Policy Documentation
    - FRR-UCM-03 Compliance Report
  required_for_fedramp: true
  authorization_package_section: Section 3 - Access Control
azure_guidance:
  recommended_services:
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Update Streams (Moderate) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Update Streams (Moderate) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Log Analytics
    tier: Standard
    purpose: Required for Update Streams (Moderate) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Govern
    guidance: Implement Update Streams (Moderate) as part of governance baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/govern/
compliance_frameworks:
  fedramp_20x:
    requirement_id: FRR-UCM-03
    requirement_name: Update Streams (Moderate)
    requirement_type: FRR
    primary_keyword: SHOULD
    impact_levels:
    - Moderate
  nist_800_53_rev5:
    controls:
    - control_id: SC-13
      control_name: Cryptographic Protection
    - control_id: SC-12
      control_name: Cryptographic Key Establishment and Management
    - control_id: IA-7
      control_name: Cryptographic Module Authentication
testing:
  validation_procedures:
  - procedure: Review policy documentation
    expected_outcome: Policy exists and is current (within 1 year)
    frequency: annual
  - procedure: Verify implementation evidence
    expected_outcome: Evidence artifacts collected and retained
    frequency: quarterly
  - procedure: Test automated controls (if applicable)
    expected_outcome: Automated controls functioning as designed
    frequency: monthly
  acceptance_criteria:
  - Policy documented for FRR-UCM-03
  - Implementation evidence collected and retained for 3 years
  - Annual review completed and documented
  - NIST controls SC-13, SC-12, IA-7 satisfied

---
pattern_id: frr.ucm.04
name: Update Streams (High)
description: Providers MUST use cryptographic modules or update streams of cryptographic
  modules with active validations under the NIST Cryptographic Module Validation Program
  when using cryptographic services to protect _federal customer data_.
family: UCM
severity: HIGH
pattern_type: process_based
languages:
  markdown:
    file_patterns:
    - '*.md'
    - README.md
    - SECURITY.md
    keywords: []
  yaml:
    file_patterns:
    - '*.yaml'
    - '*.yml'
    - .github/**/*.yml
    keywords:
    - fedramp
    - compliance
    - security
finding:
  title_template: Update Streams (High) - FRR-UCM-04
  description_template: Providers MUST use cryptographic modules or update streams
    of cryptographic modules with active validations under the NIST Cryptographic
    Module Validation Program when using cryptographic services to protect _federal
    customer data_.
  remediation_template: 'To comply with FRR-UCM-04 (Update Streams (High)), you MUST
    implement the following mandatory requirements:


    1. Review FedRAMP 20x requirement documentation

    2. Identify systems and resources in scope

    3. Create resource group for FedRAMP resources

    4. Set up Azure Key Vault for secrets management

    5. Configure Log Analytics workspace


    (See full implementation checklist for 10 total steps)'
  evidence_collection:
  - Configuration export from Azure Portal (JSON format)
  - Azure Policy compliance reports
  - Azure Monitor logs showing compliance status
  azure_services: &id001
  - Azure Blob Storage
  - Azure Monitor
  - Log Analytics
tags:
- ucm
- must
- process_based
- impact_high
- code_detectable
nist_controls:
- SC-13
- SC-12
- IA-7
related_ksis:
- KSI-CNA-05
- KSI-IAM-03
- KSI-CED-03
related_frrs: []
evidence_collection:
  azure_monitor_kql: []
  azure_cli:
  - command: '# TODO: Add Azure CLI command for FRR-UCM-04'
    description: Collect evidence for Update Streams (High)
    output_format: json
    frequency: monthly
  powershell: []
  rest_api: []
  manual_procedures:
  - procedure: Configuration export from Azure Portal (JSON format)
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Policy compliance reports
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
  - procedure: Azure Monitor logs showing compliance status
    frequency: quarterly
    responsible_party: Security team
    documentation: Required for FedRAMP authorization package
evidence_artifacts:
- artifact_type: documentation
  name: FRR-UCM-04 - Update Streams (High) Policy
  source: Organization security documentation
  frequency: annual_review
  retention_months: 36
  format: PDF/Markdown
- artifact_type: configuration
  name: FRR-UCM-04 - Azure Service Configuration
  source: Azure Portal export
  frequency: quarterly
  retention_months: 36
  format: JSON
- artifact_type: report
  name: FRR-UCM-04 - Compliance Status Report
  source: Compliance tracking system
  frequency: monthly
  retention_months: 36
  format: PDF/Excel
automation:
  automation_1:
    description: Azure Policy for compliance enforcement
    implementation: '# TODO: Add implementation for Azure Policy for compliance enforcement'
    azure_services: *id001
    effort_hours: 8
  automation_2:
    description: Azure Monitor for continuous monitoring
    implementation: '# TODO: Add implementation for Azure Monitor for continuous monitoring'
    azure_services: *id001
    effort_hours: 8
  automation_3:
    description: Log Analytics queries for compliance validation
    implementation: '# TODO: Add implementation for Log Analytics queries for compliance
      validation'
    azure_services: *id001
    effort_hours: 8
implementation:
  prerequisites:
  - FedRAMP authorization package template
  - Organization security policies
  - Azure subscription (if applicable)
  - Security team approval process
  steps:
  - step: 1
    action: Review FedRAMP 20x requirement documentation
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 2
    action: Identify systems and resources in scope
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 3
    action: Create resource group for FedRAMP resources
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 4
    action: Set up Azure Key Vault for secrets management
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 5
    action: Configure Log Analytics workspace
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 6
    action: Generate infrastructure-as-code templates (Bicep/Terraform)
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 7
    action: Deploy infrastructure via CI/CD pipeline
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 8
    action: Implement automated compliance checking
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 9
    action: Set up automated evidence collection
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  - step: 10
    action: Test detection logic against sample code
    azure_service: null
    estimated_hours: 2
    validation: Document completion and obtain approval
  total_effort_hours: 20
ssp_mapping:
  control_family: SC - Cryptographic Protection
  control_numbers:
  - SC-13
  - SC-12
  - IA-7
  ssp_sections:
  - section: 'SC-13: Cryptographic Protection'
    description_template: 'Implementation of FRR-UCM-04 - Update Streams (High):


      Providers MUST use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-04 Policy Documentation
    - FRR-UCM-04 Compliance Report
  - section: 'SC-12: Cryptographic Key Establishment and Management'
    description_template: 'Implementation of FRR-UCM-04 - Update Streams (High):


      Providers MUST use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-04 Policy Documentation
    - FRR-UCM-04 Compliance Report
  - section: 'IA-7: Cryptographic Module Authentication'
    description_template: 'Implementation of FRR-UCM-04 - Update Streams (High):


      Providers MUST use cryptographic modules or update streams of cryptographic
      modules with active validations under the NIST Cryptographic Module Validation
      Program when using cryptographic services to protect _federal customer data_.'
    implementation_details: '# TODO: Add specific implementation details'
    evidence_references:
    - FRR-UCM-04 Policy Documentation
    - FRR-UCM-04 Compliance Report
  required_for_fedramp: true
  authorization_package_section: Section 3 - Access Control
azure_guidance:
  recommended_services:
  - service: Azure Blob Storage
    tier: Standard
    purpose: Required for Update Streams (High) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Azure Monitor
    tier: Standard
    purpose: Required for Update Streams (High) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  - service: Log Analytics
    tier: Standard
    purpose: Required for Update Streams (High) compliance
    monthly_cost_estimate: Varies by usage
    alternatives: []
  well_architected_framework:
    pillar: Security
    design_area: Identity and Access Management
    reference_url: https://learn.microsoft.com/azure/well-architected/security/
  cloud_adoption_framework:
    stage: Govern
    guidance: Implement Update Streams (High) as part of governance baseline
    reference_url: https://learn.microsoft.com/azure/cloud-adoption-framework/govern/
compliance_frameworks:
  fedramp_20x:
    requirement_id: FRR-UCM-04
    requirement_name: Update Streams (High)
    requirement_type: FRR
    primary_keyword: MUST
    impact_levels:
    - High
  nist_800_53_rev5:
    controls:
    - control_id: SC-13
      control_name: Cryptographic Protection
    - control_id: SC-12
      control_name: Cryptographic Key Establishment and Management
    - control_id: IA-7
      control_name: Cryptographic Module Authentication
testing:
  validation_procedures:
  - procedure: Review policy documentation
    expected_outcome: Policy exists and is current (within 1 year)
    frequency: annual
  - procedure: Verify implementation evidence
    expected_outcome: Evidence artifacts collected and retained
    frequency: quarterly
  - procedure: Test automated controls (if applicable)
    expected_outcome: Automated controls functioning as designed
    frequency: monthly
  acceptance_criteria:
  - Policy documented for FRR-UCM-04
  - Implementation evidence collected and retained for 3 years
  - Annual review completed and documented
  - NIST controls SC-13, SC-12, IA-7 satisfied
